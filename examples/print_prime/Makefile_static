all:obj/main patch/patch.so

obj/main:main.c
	mkdir -p obj
	gcc main.c -ltfix -static -O2 -o obj/main

patch/patch.so:patch.c
	mkdir -p patch
	gcc patch.c -c -O2 -fPIC -o patch/patch.o
	ld patch/patch.o -shared -fno-plt --defsym global_data=0xc0ffee --defsym print_global=0xc0ffee -o patch/patch.so

.PHONY: clean

clean:
	rm -rf obj
	rm -rf patch